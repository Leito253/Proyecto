{"ast":null,"code":"import React,{useEffect,useState}from\"react\";import{useParams,useNavigate}from\"react-router-dom\";import\"../Styles/LibroDetalle.css\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";export default function LibroDetalle(){const{id}=useParams();const navigate=useNavigate();const[libro,setLibro]=useState(null);const[reseñas,setReseñas]=useState([]);const[nuevoComentario,setNuevoComentario]=useState(\"\");const[nuevaPuntuacion,setNuevaPuntuacion]=useState(5);const usuario=JSON.parse(localStorage.getItem(\"usuario\")||\"{}\");useEffect(()=>{fetch(\"http://localhost:5072/api/libros/\".concat(id)).then(res=>res.json()).then(data=>setLibro(data)).catch(err=>console.error(err));},[id]);useEffect(()=>{fetch(\"http://localhost:5072/api/rese\\xF1as/libro/\".concat(id)).then(res=>res.json()).then(data=>setReseñas(data)).catch(err=>console.error(err));},[id]);if(!libro)return/*#__PURE__*/_jsx(\"h2\",{children:\"Cargando libro...\"});if(!reseñas)return/*#__PURE__*/_jsx(\"h2\",{children:\"Cargando rese\\xF1as...\"});const handleAgregarReseña=()=>{if(!usuario.email){alert(\"Debes iniciar sesión para dejar una reseña.\");return;}const token=localStorage.getItem(\"token\");fetch(\"http://localhost:5072/api/reseñas\",{method:\"POST\",headers:{\"Content-Type\":\"application/json\",Authorization:\"Bearer \".concat(token)},body:JSON.stringify({libroId:parseInt(id),usuarioId:usuario.id,contenido:nuevoComentario,puntuacion:nuevaPuntuacion})}).then(res=>res.json()).then(data=>{setReseñas(prev=>[data,...prev]);setNuevoComentario(\"\");setNuevaPuntuacion(5);}).catch(err=>console.error(err));};return/*#__PURE__*/_jsxs(\"div\",{className:\"libro-detalle\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"btn-volver\",onClick:()=>navigate(-1),children:\"\\u2B05 Volver\"}),/*#__PURE__*/_jsx(\"h1\",{className:\"titulo-libro\",children:libro.titulo}),/*#__PURE__*/_jsx(\"p\",{className:\"descripcion-libro\",children:libro.descripcion}),/*#__PURE__*/_jsx(\"div\",{className:\"pdf-container\",children:/*#__PURE__*/_jsx(\"iframe\",{src:\"http://localhost:5072\".concat(libro.urlPdf),title:libro.titulo,className:\"pdf-viewer\"})}),/*#__PURE__*/_jsx(\"hr\",{}),/*#__PURE__*/_jsx(\"h2\",{children:\"Rese\\xF1as\"}),usuario.email&&/*#__PURE__*/_jsxs(\"div\",{className:\"nueva-rese\\xF1a\",children:[/*#__PURE__*/_jsx(\"textarea\",{placeholder:\"Escribe tu rese\\xF1a...\",value:nuevoComentario,onChange:e=>setNuevoComentario(e.target.value)}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsxs(\"label\",{children:[\"Puntuaci\\xF3n:\",/*#__PURE__*/_jsx(\"select\",{value:nuevaPuntuacion,onChange:e=>setNuevaPuntuacion(parseInt(e.target.value)),children:[1,2,3,4,5].map(num=>/*#__PURE__*/_jsx(\"option\",{value:num,children:num},num))})]}),/*#__PURE__*/_jsx(\"button\",{onClick:handleAgregarReseña,children:\"Agregar Rese\\xF1a\"})]}),reseñas.length===0?/*#__PURE__*/_jsx(\"p\",{children:\"No hay rese\\xF1as a\\xFAn.\"}):reseñas.map(r=>/*#__PURE__*/_jsxs(\"div\",{className:\"rese\\xF1a\",children:[/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Usuario ID:\"}),\" \",r.usuarioId]}),/*#__PURE__*/_jsx(\"p\",{children:r.comentario}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Puntuaci\\xF3n:\"}),\" \",r.puntuacion,\"/5\"]}),/*#__PURE__*/_jsx(\"hr\",{})]},r.id))]});}","map":{"version":3,"names":["React","useEffect","useState","useParams","useNavigate","jsx","_jsx","jsxs","_jsxs","LibroDetalle","id","navigate","libro","setLibro","reseñas","setReseñas","nuevoComentario","setNuevoComentario","nuevaPuntuacion","setNuevaPuntuacion","usuario","JSON","parse","localStorage","getItem","fetch","concat","then","res","json","data","catch","err","console","error","children","handleAgregarReseña","email","alert","token","method","headers","Authorization","body","stringify","libroId","parseInt","usuarioId","contenido","puntuacion","prev","className","onClick","titulo","descripcion","src","urlPdf","title","placeholder","value","onChange","e","target","map","num","length","r","comentario"],"sources":["/mnt/Datos/Repos/Proyecto/Frontend/src/pages/LibroDetalle.jsx"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport { useParams, useNavigate } from \"react-router-dom\";\nimport \"../Styles/LibroDetalle.css\";\n\nexport default function LibroDetalle() {\n  const { id } = useParams();\n  const navigate = useNavigate();\n  const [libro, setLibro] = useState(null);\n  const [reseñas, setReseñas] = useState([]);\n  const [nuevoComentario, setNuevoComentario] = useState(\"\");\n  const [nuevaPuntuacion, setNuevaPuntuacion] = useState(5);\n\n  const usuario = JSON.parse(localStorage.getItem(\"usuario\") || \"{}\");\n\n  useEffect(() => {\n    fetch(`http://localhost:5072/api/libros/${id}`)\n      .then((res) => res.json())\n      .then((data) => setLibro(data))\n      .catch((err) => console.error(err));\n  }, [id]);\n\n  useEffect(() => {\n    fetch(`http://localhost:5072/api/reseñas/libro/${id}`)\n      .then((res) => res.json())\n      .then((data) => setReseñas(data))\n      .catch((err) => console.error(err));\n  }, [id]);\n\n  if (!libro) return <h2>Cargando libro...</h2>;\n  if (!reseñas) return <h2>Cargando reseñas...</h2>;\n  \n  const handleAgregarReseña = () => {\n    if (!usuario.email) {\n      alert(\"Debes iniciar sesión para dejar una reseña.\");\n      return;\n    }\n\n    const token = localStorage.getItem(\"token\");\n\n    fetch(\"http://localhost:5072/api/reseñas\", {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n        Authorization: `Bearer ${token}`,\n      },\n      body: JSON.stringify({\n        libroId: parseInt(id),\n        usuarioId: usuario.id,\n        contenido: nuevoComentario,\n        puntuacion: nuevaPuntuacion,\n      }),\n    })\n      .then((res) => res.json())\n      .then((data) => {\n        setReseñas((prev) => [data, ...prev]);\n        setNuevoComentario(\"\");\n        setNuevaPuntuacion(5);\n      })\n      .catch((err) => console.error(err));\n  };\n\n  return (\n    <div className=\"libro-detalle\">\n      <button className=\"btn-volver\" onClick={() => navigate(-1)}>\n        ⬅ Volver\n      </button>\n\n      <h1 className=\"titulo-libro\">{libro.titulo}</h1>\n      <p className=\"descripcion-libro\">{libro.descripcion}</p>\n\n      <div className=\"pdf-container\">\n        <iframe\n          src={`http://localhost:5072${libro.urlPdf}`}\n          title={libro.titulo}\n          className=\"pdf-viewer\"\n        />\n      </div>\n      <hr />\n      <h2>Reseñas</h2>\n\n      {usuario.email && (\n        <div className=\"nueva-reseña\">\n          <textarea\n            placeholder=\"Escribe tu reseña...\"\n            value={nuevoComentario}\n            onChange={(e) => setNuevoComentario(e.target.value)}\n          />\n          <br />\n          <label>\n            Puntuación:\n            <select\n              value={nuevaPuntuacion}\n              onChange={(e) => setNuevaPuntuacion(parseInt(e.target.value))}\n            >\n              {[1, 2, 3, 4, 5].map((num) => (\n                <option key={num} value={num}>\n                  {num}\n                </option>\n              ))}\n            </select>\n          </label>\n          <button onClick={handleAgregarReseña}>Agregar Reseña</button>\n        </div>\n      )}\n\n      {reseñas.length === 0 ? (\n        <p>No hay reseñas aún.</p>\n      ) : (\n        reseñas.map((r) => (\n          <div key={r.id} className=\"reseña\">\n            <p><strong>Usuario ID:</strong> {r.usuarioId}</p>\n            <p>{r.comentario}</p>\n            <p><strong>Puntuación:</strong> {r.puntuacion}/5</p>\n            <hr />\n          </div>\n        ))\n      )}\n    </div>\n  );\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}